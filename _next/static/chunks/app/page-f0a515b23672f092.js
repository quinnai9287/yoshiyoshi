(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1097:function(e,t,l){Promise.resolve().then(l.bind(l,7039))},7039:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return g}});var c=l(6943),r=l(7879),a=l(9906),i=l(9008),s=l(2245),n=l(8926),d=l(7380),u=l(2107),o=l.n(u),h=e=>{let{onLongPress:t,onClick:l,onBlur:a,children:i,disabled:s=!1}=e,[n,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),m=(0,r.useCallback)(o().debounce(()=>{x(!0)},300),[]);(0,r.useEffect)(()=>()=>{n&&clearTimeout(n),m.cancel()},[n,m]);let P=()=>{m(),u(setTimeout(()=>{h&&(t(),x(!1))},500))},p=()=>{n&&clearTimeout(n),m.cancel(),x(!1)};return(0,c.jsx)(d.ZP,{onMouseDown:P,onMouseUp:p,onMouseLeave:p,onTouchStart:P,onTouchEnd:p,onClick:l,onBlur:a,className:"w-[48px] h-[48px] flex items-center justify-center",style:{fontSize:"16px",backgroundColor:h?"#ddd":"#fff"},disabled:s,children:i})},x=e=>{let{min:t=0,max:l=100,step:i=1,name:d,value:u,setValue:o,disabled:x=!1,disabledDecrease:m=!1,disabledIncrease:P=!1,onChange:p,onFocus:f,onBlur:j}=e,[g,b]=r.useState(0),v=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(v.current){let e=new Event("input",{bubbles:!0});v.current.value=String(g),v.current.dispatchEvent(e)}},[g]),(0,r.useEffect)(()=>{b(u)},[u]),(0,c.jsxs)(a.Z,{onBlur:j,onFocus:f,gap:8,children:[(0,c.jsx)(h,{onLongPress:()=>{alert("long press")},disabled:m,onClick:()=>{o(e=>e-i)},children:(0,c.jsx)(s.Z,{})}),(0,c.jsx)("input",{ref:v,min:t,max:l,name:d,step:i,value:g,onInput:p,className:"text-center w-[48px] h-[48]",disabled:x}),(0,c.jsx)(h,{onLongPress:()=>{alert("long press")},disabled:P,onClick:()=>{o(e=>e+i)},children:(0,c.jsx)(n.Z,{})})]})},m=e=>{let{adult:t,child:l,step:i,capacity:s,restOfAllocatedAdults:n,restOfAllocatedChildren:d,onChange:u,onBlur:o,onFocus:h}=e,[m,P]=(0,r.useState)(t),[p,f]=(0,r.useState)(l);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,c.jsx)("div",{children:"大人"}),(0,c.jsx)(x,{min:0,max:30,step:i,name:"adult",value:m,setValue:P,disabled:!1,disabledDecrease:m<=0,disabledIncrease:m+p>=s||n<=0,onChange:u,onFocus:h,onBlur:o})]}),(0,c.jsxs)(a.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,c.jsx)("div",{children:"小孩"}),(0,c.jsx)(x,{min:0,max:30,step:i,name:"child",value:p,setValue:f,disabled:!1,disabledDecrease:p<=0,disabledIncrease:m+p>=s||d<=0,onChange:u,onFocus:h,onBlur:o})]})]})},P=e=>{let{currentTest:t,onChange:l}=e,[i,s]=(0,r.useState)(0),[n,d]=(0,r.useState)({adult:0,child:0}),[u,o]=(0,r.useState)([]),[h,x]=(0,r.useState)(0),[P,p]=(0,r.useState)(0),[f,j]=(0,r.useState)(0),[g,b]=(0,r.useState)(0),[v,y]=(0,r.useState)([]),S=(e,t)=>{let l=e.adult*u[t].adultPrice,c=e.child*u[t].childPrice;return u[t].roomPrice+l+c},Z=(e,t)=>{let{name:c,value:r}=e.target,a=Number(r),i=[...v],s={...v[t]},n=s[c];s[c]=a,s.price=S(s,t),i[t]=s,console.log("[change]:",c,"newValue",a,"oldValue",n),"adult"===c?x(e=>e+(a-n)):"child"===c&&p(e=>e+(a-n)),l(i),y(i)},C=(0,r.useCallback)((e,t)=>{let l=[];t.sort((e,t)=>e.roomPrice+e.adultPrice+e.childPrice-(t.roomPrice+t.adultPrice+t.childPrice));for(let e=0;e<t.length;e++)l.push({adult:0,child:0,price:t[e].roomPrice+0*t[e].adultPrice+0*t[e].childPrice});return l},[]);return(0,r.useEffect)(()=>{s(1)},[]),(0,r.useEffect)(()=>{let{guest:e,rooms:l}=t;d(e),o(l),x(0),p(0),y(C(e,l)||[])},[t,C]),(0,r.useEffect)(()=>{if(n){let e=Math.max(0,n.adult-h),t=Math.max(0,n.child-P);j(e),b(t)}},[h,P,n]),(0,c.jsxs)(a.Z,{vertical:!0,children:[n&&u.length>0&&(0,c.jsx)(a.Z,{children:(0,c.jsxs)(a.Z,{className:"text-2xl font-bold",children:[(0,c.jsx)("h2",{children:"住客人數："}),n.adult," 位大人，",n.child," 位小孩 / ",u.length," 房"]})}),(0,c.jsx)(a.Z,{vertical:!0,children:n?n.adult>0&&n.child<=n.adult?(0,c.jsxs)(a.Z,{className:"text-base bg-slate-200 w-full mt-2 p-4 ",children:[(0,c.jsx)("h2",{children:"尚未分配人數："}),f," 位大人，",g," 位小孩"]}):(0,c.jsx)(a.Z,{justify:"center",className:"text-base bg-slate-200 w-full mt-2 p-4",children:"至少要有一位成人陪伴孩童"}):null}),(0,c.jsx)(a.Z,{vertical:!0,className:"text-lg font-bold mb-4 divide-y",children:n&&n.adult>0&&n.child<=n.adult&&v.map((e,t)=>(0,c.jsx)(a.Z,{vertical:!0,className:"text-lg font-bold mb-4 py-4",children:(0,c.jsxs)(a.Z,{vertical:!0,gap:8,children:[(0,c.jsxs)("h3",{children:["房間 ",t+1,"："]}),(0,c.jsx)(m,{adult:e.adult,child:e.child,capacity:u[t].capacity,step:i,restOfAllocatedAdults:f,restOfAllocatedChildren:g,onChange:e=>Z(e,t),onFocus:e=>{},onBlur:e=>{}}),(0,c.jsxs)("div",{children:["價格: ",e.price]})]})},t))})]})},p=e=>{let{currentTest:t}=e;return(0,c.jsx)(i.Z,{style:{width:500},children:(0,c.jsx)(P,{currentTest:t,onChange:e=>{console.log("RoomAllocation:[onChange]",e)}})})};let f=[{guest:{adult:4,child:2},rooms:[{roomPrice:1e3,adultPrice:200,childPrice:100,capacity:4},{roomPrice:0,adultPrice:500,childPrice:500,capacity:4},{roomPrice:500,adultPrice:300,childPrice:200,capacity:4}]},{guest:{adult:16,child:0},rooms:[{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8},{roomPrice:500,adultPrice:1e3,childPrice:600,capacity:2}]},{guest:{adult:0,child:1},rooms:[{roomPrice:1e3,adultPrice:500,childPrice:300,capacity:2},{roomPrice:500,adultPrice:400,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8}]}];var j=e=>{let{currentTest:t,setCurrentTest:l}=e;return(0,c.jsx)(a.Z,{gap:8,children:f.map((e,t)=>(0,c.jsx)(d.ZP,{onClick:()=>{l(e)},children:"testCase ".concat(t+1)},t))})},g=()=>{let[e,t]=(0,r.useState)(f[0]);return(0,c.jsxs)(a.Z,{vertical:!0,gap:"large",align:"center",children:[(0,c.jsx)("h1",{className:"text-3xl font-bold",children:"YOSHI YOSHI"}),(0,c.jsx)(j,{currentTest:e,setCurrentTest:t}),(0,c.jsx)(p,{currentTest:e})]})}}},function(e){e.O(0,[495,787,922,465,744],function(){return e(e.s=1097)}),_N_E=e.O()}]);