(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1097:function(e,t,l){Promise.resolve().then(l.bind(l,7039))},7039:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return p}});var r=l(6943),c=l(7879),i=l(9906),a=l(9008),n=l(2245),s=l(8926),u=l(7380),d=e=>{let{onLongPress:t,onClick:l,onBlur:i,children:a,disabled:n=!1}=e,[s,d]=(0,c.useState)(!1),o=(0,c.useRef)(null),h=(0,c.useRef)(null);(0,c.useEffect)(()=>(s?o.current=window.setTimeout(()=>{h.current=window.setInterval(()=>{t()},100)},1e3):(null!==o.current&&(clearTimeout(o.current),o.current=null),null!==h.current&&(clearInterval(h.current),h.current=null)),()=>{null!==o.current&&(clearTimeout(o.current),o.current=null),null!==h.current&&(clearInterval(h.current),h.current=null)}),[s,t]);let x=()=>{d(!1)};return(0,r.jsx)(u.ZP,{onClick:l,onMouseDown:()=>{d(!0)},onMouseUp:x,onMouseLeave:x,onBlur:i,className:"w-[48px] h-[48px] flex items-center justify-center",style:{fontSize:"16px",backgroundColor:s?"#ddd":"#fff"},disabled:n,children:a})},o=e=>{let{min:t=0,max:l=100,step:a=1,name:u,value:o,setValue:h,disabled:x=!1,disabledDecrease:m=!1,disabledIncrease:P=!1,onChange:f,onFocus:p,onBlur:j}=e,b=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(b.current){let e=new Event("input",{bubbles:!0});b.current.value=String(o),b.current.dispatchEvent(e)}},[o]);let g=()=>{o<=l&&o>=0&&h(e=>e+a)},v=()=>{o<=l&&o>=0&&h(e=>e-a)};return(0,r.jsxs)(i.Z,{onBlur:j,onFocus:p,gap:8,children:[(0,r.jsx)(d,{onClick:v,onLongPress:v,disabled:m,children:(0,r.jsx)(n.Z,{})}),(0,r.jsx)("input",{ref:b,min:t,max:l,name:u,step:a,onInput:f,className:"text-center w-[48px] h-[48] border border-gray-300 rounded-md",disabled:x}),(0,r.jsx)(d,{onClick:g,onLongPress:g,disabled:P,children:(0,r.jsx)(s.Z,{})})]})},h=e=>{let{adult:t,child:l,step:a,capacity:n,restOfAllocatedAdults:s,restOfAllocatedChildren:u,onChange:d,onBlur:h,onFocus:x}=e,[m,P]=(0,c.useState)(t),[f,p]=(0,c.useState)(l);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,r.jsx)("div",{children:"大人"}),(0,r.jsx)(o,{min:0,max:n,step:a,name:"adult",value:m,setValue:P,disabled:m<=0||m+f>=n||s<=0,disabledDecrease:m<=0,disabledIncrease:m+f>=n||s<=0,onChange:d,onFocus:x,onBlur:h})]}),(0,r.jsxs)(i.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,r.jsx)("div",{children:"小孩"}),(0,r.jsx)(o,{min:0,max:n,step:a,name:"child",value:f,setValue:p,disabled:f<=0||m+f>=n||u<=0,disabledDecrease:f<=0,disabledIncrease:m+f>=n||u<=0,onChange:d,onFocus:x,onBlur:h})]})]})},x=e=>{let{currentTest:t,onChange:l}=e,[a,n]=(0,c.useState)(0),[s,u]=(0,c.useState)({adult:0,child:0}),[d,o]=(0,c.useState)([]),[x,m]=(0,c.useState)(0),[P,f]=(0,c.useState)(0),[p,j]=(0,c.useState)(0),[b,g]=(0,c.useState)(0),[v,y]=(0,c.useState)([]),Z=(e,t)=>{let l=e.adult*d[t].adultPrice,r=e.child*d[t].childPrice;return d[t].roomPrice+l+r},w=(e,t)=>{let{name:r,value:c}=e.target,i=Number(c),a=[...v],n={...v[t]},s=n[r];n[r]=i,n.price=Z(n,t),a[t]=n,"adult"===r?m(e=>e+(i-s)):"child"===r&&f(e=>e+(i-s)),l(a),y(a)},C=(0,c.useCallback)((e,t)=>{let l=[];t.sort((e,t)=>e.roomPrice+e.adultPrice+e.childPrice-(t.roomPrice+t.adultPrice+t.childPrice));for(let e=0;e<t.length;e++)l.push({adult:0,child:0,price:t[e].roomPrice+0*t[e].adultPrice+0*t[e].childPrice});return l},[]);return(0,c.useEffect)(()=>{n(1)},[]),(0,c.useEffect)(()=>{let{guest:e,rooms:l}=t;u(e),o(l),m(0),f(0),y(C(e,l)||[])},[t,C]),(0,c.useEffect)(()=>{if(s){let e=Math.max(0,s.adult-x),t=Math.max(0,s.child-P);j(e),g(t)}},[x,P,s]),(0,r.jsxs)(i.Z,{vertical:!0,children:[s&&d.length>0&&(0,r.jsx)(i.Z,{children:(0,r.jsxs)(i.Z,{className:"text-2xl font-bold",children:[(0,r.jsx)("h2",{children:"住客人數："}),s.adult," 位大人，",s.child," 位小孩 / ",d.length," 房"]})}),(0,r.jsx)(i.Z,{vertical:!0,children:s?s.adult>0&&s.child<=s.adult?(0,r.jsxs)(i.Z,{className:"text-base bg-slate-200 w-full mt-2 p-4 ",children:[(0,r.jsx)("h2",{children:"尚未分配人數："}),p," 位大人，",b," 位小孩"]}):(0,r.jsx)(i.Z,{justify:"center",className:"text-base bg-slate-200 w-full mt-2 p-4",children:"至少要有一位成人陪伴孩童"}):null}),(0,r.jsx)(i.Z,{vertical:!0,className:"text-lg font-bold mb-4 divide-y",children:s&&s.adult>0&&s.child<=s.adult&&v.map((e,t)=>(0,r.jsx)(i.Z,{vertical:!0,className:"text-lg font-bold mb-4 py-4",children:(0,r.jsxs)(i.Z,{vertical:!0,gap:8,children:[(0,r.jsxs)("h3",{children:["房間 ",t+1,"："]}),(0,r.jsx)(h,{adult:e.adult,child:e.child,capacity:d[t].capacity,step:a,restOfAllocatedAdults:p,restOfAllocatedChildren:b,onChange:e=>w(e,t),onFocus:e=>{},onBlur:e=>{}}),(0,r.jsxs)("div",{children:["價格: ",e.price]})]})},t))})]})},m=e=>{let{currentTest:t}=e;return(0,r.jsx)(a.Z,{style:{width:500},children:(0,r.jsx)(x,{currentTest:t,onChange:e=>{console.log("RoomAllocation:[onChange]",e)}})})};let P=[{guest:{adult:4,child:2},rooms:[{roomPrice:1e3,adultPrice:200,childPrice:100,capacity:4},{roomPrice:0,adultPrice:500,childPrice:500,capacity:4},{roomPrice:500,adultPrice:300,childPrice:200,capacity:4}]},{guest:{adult:16,child:0},rooms:[{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8},{roomPrice:500,adultPrice:1e3,childPrice:600,capacity:2}]},{guest:{adult:0,child:1},rooms:[{roomPrice:1e3,adultPrice:500,childPrice:300,capacity:2},{roomPrice:500,adultPrice:400,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8}]}];var f=e=>{let{currentTest:t,setCurrentTest:l}=e;return(0,r.jsx)(i.Z,{gap:8,children:P.map((e,t)=>(0,r.jsx)(u.ZP,{onClick:()=>{l(e)},children:"testCase ".concat(t+1)},t))})},p=()=>{let[e,t]=(0,c.useState)(P[0]);return(0,r.jsxs)(i.Z,{vertical:!0,gap:"large",align:"center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"YOSHI YOSHI"}),(0,r.jsx)(f,{currentTest:e,setCurrentTest:t}),(0,r.jsx)(m,{currentTest:e})]})}}},function(e){e.O(0,[787,922,465,744],function(){return e(e.s=1097)}),_N_E=e.O()}]);