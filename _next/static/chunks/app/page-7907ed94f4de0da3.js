(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1097:function(e,t,l){Promise.resolve().then(l.bind(l,9617))},9617:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return j}});var r=l(6943),c=l(7879),a=l(9906),i=l(7380),n=l(9008),s=l(2245),u=l(8926),d=e=>{let{onLongPress:t,onClick:l,onBlur:a,children:n,disabled:s=!1}=e,[u,d]=(0,c.useState)(!1),o=(0,c.useRef)(null),h=(0,c.useRef)(null);(0,c.useEffect)(()=>(u?o.current=window.setTimeout(()=>{h.current=window.setInterval(()=>{t()},100)},1e3):(null!==o.current&&(clearTimeout(o.current),o.current=null),null!==h.current&&(clearInterval(h.current),h.current=null)),()=>{null!==o.current&&(clearTimeout(o.current),o.current=null),null!==h.current&&(clearInterval(h.current),h.current=null)}),[u,t]);let m=()=>{d(!1)};return(0,r.jsx)(i.ZP,{onClick:l,onMouseDown:()=>{d(!0)},onMouseUp:m,onMouseLeave:m,onBlur:a,className:"w-[48px] h-[48px] flex items-center justify-center",style:{fontSize:"16px",backgroundColor:u?"#ddd":"#fff"},disabled:s,children:n})},o=e=>{let{min:t=0,max:l=100,step:i=1,name:n,value:o,setValue:h,disabled:m=!1,disabledDecrease:x=!1,disabledIncrease:P=!1,onChange:p,onFocus:f,onBlur:j}=e,g=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(g.current){let e=new Event("input",{bubbles:!0});g.current.value=String(o),g.current.dispatchEvent(e)}},[o]);let b=()=>{o<=l&&o>=0&&h(e=>e+i)},v=()=>{o<=l&&o>=0&&h(e=>e-i)};return(0,r.jsxs)(a.Z,{onBlur:j,onFocus:f,gap:8,children:[(0,r.jsx)(d,{onClick:v,onLongPress:v,disabled:x,children:(0,r.jsx)(s.Z,{})}),(0,r.jsx)("input",{ref:g,min:t,max:l,name:n,step:i,onInput:e=>Number(e.target.value)<t?h(t):Number(e.target.value)>l?h(l):void p(e),className:"text-center w-[48px] h-[48] border border-gray-300 rounded-md",disabled:m}),(0,r.jsx)(d,{onClick:b,onLongPress:b,disabled:P,children:(0,r.jsx)(u.Z,{})})]})},h=e=>{let{adult:t,child:l,step:i,capacity:n,restOfAllocatedAdults:s,restOfAllocatedChildren:u,onChange:d,onBlur:h,onFocus:m}=e,[x,P]=(0,c.useState)(0),[p,f]=(0,c.useState)(0);return(0,c.useEffect)(()=>{P(t),f(l)},[t,l]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,r.jsx)("div",{children:"大人"}),(0,r.jsx)(o,{min:0,max:n,step:i,name:"adult",value:x,setValue:P,disabled:x<0||x+p>n||s<0,disabledDecrease:x<=0,disabledIncrease:x+p>=n||s<=0,onChange:d,onFocus:m,onBlur:h})]}),(0,r.jsxs)(a.Z,{justify:"space-between",align:"center",className:"w-full",children:[(0,r.jsx)("div",{children:"小孩"}),(0,r.jsx)(o,{min:0,max:n,step:i,name:"child",value:p,setValue:f,disabled:p<0||x+p>n||u<0,disabledDecrease:p<=0,disabledIncrease:x+p>=n||u<=0,onChange:d,onFocus:m,onBlur:h})]})]})};let m=(e,t)=>{let{adult:l,child:r}=e,c=t.length,a=[],i=1/0,n=(e,l,r,s,u)=>{if(r>=c){0===e&&0===l&&u<i&&(i=u,a=[...s]);return}let{roomPrice:d,adultPrice:o,childPrice:h,capacity:m}=t[r];for(let t=0;t<=Math.min(e,m);t++)for(let c=0;c<=Math.min(l,m-t);c++){if(c>0&&0===t)continue;let a=d+t*o+c*h,i=[...s,{adult:t,child:c,price:a}];n(e-t,l-c,r+1,i,u+a)}n(e,l,r+1,s,u)};return n(l,r,0,[],0),i===1/0?[]:a};var x=e=>{let{currentTest:t,isCheapestPlan:l,onChange:i}=e,[n,s]=(0,c.useState)(0),[u,d]=(0,c.useState)({adult:0,child:0}),[o,x]=(0,c.useState)([]),[P,p]=(0,c.useState)(0),[f,j]=(0,c.useState)(0),[g,b]=(0,c.useState)(0),[v,y]=(0,c.useState)(0),[C,Z]=(0,c.useState)([]),w=(e,t)=>{let l=e.adult*o[t].adultPrice,r=e.child*o[t].childPrice;return o[t].roomPrice+l+r},N=(e,t)=>{let{name:l,value:r}=e.target,c=Number(r),a=[...C],n={...C[t]},s=n[l];n[l]=c,n.price=w(n,t),a[t]=n,"adult"===l?p(e=>e+(c-s)):"child"===l&&j(e=>e+(c-s)),i(a),Z(a)},S=(0,c.useCallback)((e,t)=>{let l=[];t.sort((e,t)=>e.roomPrice+e.adultPrice+e.childPrice-(t.roomPrice+t.adultPrice+t.childPrice));for(let e=0;e<t.length;e++)l.push({adult:0,child:0,price:t[e].roomPrice+0*t[e].adultPrice+0*t[e].childPrice});return l},[]);return(0,c.useEffect)(()=>{s(1)},[]),(0,c.useEffect)(()=>{let{guest:e,rooms:r}=t;d(e),x(r),p(0),j(0),Z((l?m(e,r):S(e,r))||[])},[t,l,S]),(0,c.useEffect)(()=>{if(u){let e=Math.max(0,u.adult-P),t=Math.max(0,u.child-f);b(e),y(t)}},[P,f,u]),(0,r.jsxs)(a.Z,{vertical:!0,children:[u&&o.length>0&&(0,r.jsx)(a.Z,{children:(0,r.jsxs)(a.Z,{className:"text-2xl font-bold",children:[(0,r.jsx)("h2",{children:"住客人數："}),u.adult," 位大人，",u.child," 位小孩 / ",o.length," 房"]})}),u.adult>0&&u.child<=u.adult&&(0,r.jsxs)("p",{children:["Total Price: ",C.reduce((e,t)=>e+t.price,0)]}),(0,r.jsx)(a.Z,{vertical:!0,children:u?u.adult>0&&u.child<=u.adult?(0,r.jsxs)(a.Z,{className:"text-base bg-slate-200 w-full mt-2 p-4 ",children:[(0,r.jsx)("h2",{children:"尚未分配人數："}),g," 位大人，",v," 位小孩"]}):(0,r.jsx)(a.Z,{justify:"center",className:"text-base bg-slate-200 w-full mt-2 p-4",children:"至少要有一位成人陪伴孩童"}):null}),(0,r.jsx)(a.Z,{vertical:!0,className:"text-lg font-bold mb-4 divide-y",children:u&&u.adult>0&&u.child<=u.adult&&C.map((e,t)=>(0,r.jsx)(a.Z,{vertical:!0,className:"text-lg font-bold mb-4 py-4",children:(0,r.jsxs)(a.Z,{vertical:!0,gap:8,children:[(0,r.jsxs)("h3",{children:["房間 ",t+1,"："]}),(0,r.jsx)(h,{adult:e.adult,child:e.child,capacity:o[t].capacity,step:n,restOfAllocatedAdults:g,restOfAllocatedChildren:v,onChange:e=>N(e,t),onFocus:e=>{},onBlur:e=>{}}),(0,r.jsxs)("div",{children:["價格: ",e.price]})]})},t))})]})},P=e=>{let{currentTest:t,isCheapestPlan:l}=e;return(0,r.jsx)(n.Z,{style:{width:500},children:(0,r.jsx)(x,{currentTest:t,isCheapestPlan:l,onChange:e=>{console.log("RoomAllocation:[onChange]",e)}})})};let p=[{guest:{adult:4,child:2},rooms:[{roomPrice:1e3,adultPrice:200,childPrice:100,capacity:4},{roomPrice:0,adultPrice:500,childPrice:500,capacity:4},{roomPrice:500,adultPrice:300,childPrice:200,capacity:4}]},{guest:{adult:16,child:0},rooms:[{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:500,adultPrice:500,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8},{roomPrice:500,adultPrice:1e3,childPrice:600,capacity:2}]},{guest:{adult:0,child:1},rooms:[{roomPrice:1e3,adultPrice:500,childPrice:300,capacity:2},{roomPrice:500,adultPrice:400,childPrice:300,capacity:4},{roomPrice:0,adultPrice:500,childPrice:300,capacity:8}]}];var f=e=>{let{currentTest:t,setCurrentTest:l}=e;return(0,r.jsx)(a.Z,{gap:8,children:p.map((e,t)=>(0,r.jsx)(i.ZP,{onClick:()=>{l(e)},children:"testCase ".concat(t+1)},t))})},j=()=>{let[e,t]=(0,c.useState)(p[0]),[l,n]=(0,c.useState)(!1);return(0,r.jsxs)(a.Z,{vertical:!0,gap:"large",align:"center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"YOSHI YOSHI"}),(0,r.jsxs)(a.Z,{gap:8,align:"center",children:[(0,r.jsx)("p",{className:"text-sm",children:"Now Plan:"}),(0,r.jsx)(i.ZP,{onClick:()=>n(!0),type:l?"primary":"default",children:"Get Cheapest Plan"}),(0,r.jsx)(i.ZP,{onClick:()=>n(!1),type:l?"default":"primary",children:"Custom Plan"})]}),(0,r.jsx)(f,{currentTest:e,setCurrentTest:t}),(0,r.jsx)(P,{currentTest:e,isCheapestPlan:l})]})}}},function(e){e.O(0,[787,922,465,744],function(){return e(e.s=1097)}),_N_E=e.O()}]);